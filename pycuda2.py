import numpy as np
from time import process_time
from skcuda import cufft as cf
import pycuda.autoinit
from pycuda import gpuarray

BATCH=1
data = np.array([011.5998449660372,16.4477574367340,4.69717667351133,3.91411426850493,3.05588658750614,-4.45480155876748,-2.66396087475018,7.54221554513682,12.8397269427868,11.8847204738406,11.7158486740892,11.1050940907217,-0.370616606586895,-0.425125141882483,1.28472176008446,-1.17493178524658,6.68758896750132,15.1444750129804,11.1942174708350,9.62076612992489,8.21367522899708,-2.38560854423819,-3.40033380456537,4.06418345935386,4.57521042477143,7.24675543353628,14.6653443318842,11.9632417636966,4.54394772421881,2.57652817164756,1.63366920086907,-5.58314744850048,0.431129541831943,8.43992076962173,5.62432228658675,12.2444644488559,12.9406112451567,2.98248926234964,-0.536167917624487,-0.916464496484099,-0.655715828124159,0.733796331922340,11.1370020372777,13.1918414775134,7.41322927340437,8.69061055706198,4.49069098890201,-3.37054383795810,-0.668215114984029,5.08767083112497,3.15529514821374,9.41231603863569,13.7708954190548,7.60654740648527,3.10086390808949,4.77557583807466,-2.70977994337034,-3.15613731770226,5.30620210004770,10.6657501919241,7.53944661141349,12.6030692363927,10.5627965733027,1.18765047967117,0.482034069012911,1.01533590610428,-2.69025453227190,3.90965662041271,12.2012969190328,13.2014698922737,7.37212628385832,9.09176290017356,0.546251486350722,-3.76995021360266,0.412055836305663,2.82366100046193,3.67364490644145,13.1463647727433,13.4952866742421,5.23063504407183,4.60757683492497,2.18008416385702,-3.83001261468943,1.08802477928820,7.65335594826139,9.57864544321221,10.7100199338476,12.8656138845006,6.12935343194416,-2.92118355016818,-0.843771290280274,0.134292621724418,0.472177775102770,11.5177808714005,12.8304764473064,9.08013117104257,8.41750557462911,4.36083481317021,-3.25021328963570,-4.89686359168650,4.22495482405339,3.07844974196104,7.76391860373974,14.2036963427076,10.8569941766881,2.88115286926895,3.91481071018109,0.156480836918994,-2.56622140774730,3.38131520517402,7.44871540956824,7.61538518308248,13.1160751120281,10.4927243731729,2.69936521241891,-1.50700774169263,2.45168416004871,-2.97704874152764,2.45194785071374,11.0924861800180,14.8481220603461,8.80945782962312,10.0898261627169,1.68952628309367,-5.09712648756634,-0.546880587287405,5.33079575281740,4.09181061035426,11.7637192846543,12.5620561222277,6.60217353674066,2.22835442297999,1.16006432484803,-2.63913861155627,-1.94838478877406,7.23307096084257,7.92765205963283,10.2427757222972,13.4159150248491,7.77110459405693,-1.07313103878133,-0.624065703658845,-1.18023351218842,-1.25561669854227,5.98036680414995,12.6755711000276,8.62878132537049,7.67001660717939,5.53954235950604,-0.213892198921448,-3.59751235443876,2.41392031854653,4.05154556843102,5.41389883905420,14.9571444806296,12.1334652089749,3.53554609333511,4.71519674383298,0.520502513058908,-5.02510637225213,1.20624640226455,8.40149322040858,7.44847814733797,13.3320838481592,14.2709182985879,4.04495274075767,-3.16358481707173,-0.0704161081852232,-0.730007496270193,1.76665943515817,9.48579087679681,10.5491157250709,6.82901189789013,9.05417268632413,5.04692361254395,-3.54657170655859,-1.89176543716917,4.16208662937246,3.54279495358351,10.1969785590622,13.6233179917995,9.17507770441653,2.25900385625912,2.90805859082582,-1.38733068367216,-2.48842547695731,4.41414781905376,10.8090527622305,9.28865404751268,12.5026462186849,9.81504835429167,-0.130566088352832,-1.36528544784286,0.952450397353966,-1.14737386578547,5.47802124788419,14.7898553390862,11.3179271039564,7.77801482693653,8.96887647355727,0.921897259940479,-5.68832818259002,2.12612690400452,4.53299188894746,5.23119577363247,13.1734171984081,13.9340681549163,4.48520276092363,3.02592901147845,1.74244515554130,-4.55983504496260,1.18242928397727,7.58209255845094,8.39820597725250,9.16292721974752,11.9351166934218,5.72144382800123,-2.02940984861865,1.83425400304237,-0.219606836805673,-1.31428967001154,10.5357469169042,14.7320462648986,8.66317369550045,6.99384029602029,5.84922991457407,-2.96718817142569,-2.82611649629994,3.12341564852295,4.40990373719430,8.05571998003280,13.4975463658717,9.60551245970737,2.74037333746217,2.91702783872892,-0.903457793285593,-4.26564014936719,0.546261399528139,9.13005603813670,9.69742233680981,10.6947793850387,12.4986078242284,2.08873234403446,-1.66006330540453,1.19743970483576,-2.58120475631329,2.56510659687001,13.9042780158808,12.0384618042568,8.02561254888418,7.97668507210365,2.71689281106863,-4.39616389384125,0.151976379371711,3.85956239320529,4.1332279593848,011.5998449660372,16.4477574367340,4.69717667351133,3.91411426850493,3.05588658750614,-4.45480155876748,-2.66396087475018,7.54221554513682,12.8397269427868,11.8847204738406,11.7158486740892,11.1050940907217,-0.370616606586895,-0.425125141882483,1.28472176008446,-1.17493178524658,6.68758896750132,15.1444750129804,11.1942174708350,9.62076612992489,8.21367522899708,-2.38560854423819,-3.40033380456537,4.06418345935386,4.57521042477143,7.24675543353628,14.6653443318842,11.9632417636966,4.54394772421881,2.57652817164756,1.63366920086907,-5.58314744850048,0.431129541831943,8.43992076962173,5.62432228658675,12.2444644488559,12.9406112451567,2.98248926234964,-0.536167917624487,-0.916464496484099,-0.655715828124159,0.733796331922340,11.1370020372777,13.1918414775134,7.41322927340437,8.69061055706198,4.49069098890201,-3.37054383795810,-0.668215114984029,5.08767083112497,3.15529514821374,9.41231603863569,13.7708954190548,7.60654740648527,3.10086390808949,4.77557583807466,-2.70977994337034,-3.15613731770226,5.30620210004770,10.6657501919241,7.53944661141349,12.6030692363927,10.5627965733027,1.18765047967117,0.482034069012911,1.01533590610428,-2.69025453227190,3.90965662041271,12.2012969190328,13.2014698922737,7.37212628385832,9.09176290017356,0.546251486350722,-3.76995021360266,0.412055836305663,2.82366100046193,3.67364490644145,13.1463647727433,13.4952866742421,5.23063504407183,4.60757683492497,2.18008416385702,-3.83001261468943,1.08802477928820,7.65335594826139,9.57864544321221,10.7100199338476,12.8656138845006,6.12935343194416,-2.92118355016818,-0.843771290280274,0.134292621724418,0.472177775102770,11.5177808714005,12.8304764473064,9.08013117104257,8.41750557462911,4.36083481317021,-3.25021328963570,-4.89686359168650,4.22495482405339,3.07844974196104,7.76391860373974,14.2036963427076,10.8569941766881,2.88115286926895,3.91481071018109,0.156480836918994,-2.56622140774730,3.38131520517402,7.44871540956824,7.61538518308248,13.1160751120281,10.4927243731729,2.69936521241891,-1.50700774169263,2.45168416004871,-2.97704874152764,2.45194785071374,11.0924861800180,14.8481220603461,8.80945782962312,10.0898261627169,1.68952628309367,-5.09712648756634,-0.546880587287405,5.33079575281740,4.09181061035426,11.7637192846543,12.5620561222277,6.60217353674066,2.22835442297999,1.16006432484803,-2.63913861155627,-1.94838478877406,7.23307096084257,7.92765205963283,10.2427757222972,13.4159150248491,7.77110459405693,-1.07313103878133,-0.624065703658845,-1.18023351218842,-1.25561669854227,5.98036680414995,12.6755711000276,8.62878132537049,7.67001660717939,5.53954235950604,-0.213892198921448,-3.59751235443876,2.41392031854653,4.05154556843102,5.41389883905420,14.9571444806296,12.1334652089749,3.53554609333511,4.71519674383298,0.520502513058908,-5.02510637225213,1.20624640226455,8.40149322040858,7.44847814733797,13.3320838481592,14.2709182985879,4.04495274075767,-3.16358481707173,-0.0704161081852232,-0.730007496270193,1.76665943515817,9.48579087679681,10.5491157250709,6.82901189789013,9.05417268632413,5.04692361254395,-3.54657170655859,-1.89176543716917,4.16208662937246,3.54279495358351,10.1969785590622,13.6233179917995,9.17507770441653,2.25900385625912,2.90805859082582,-1.38733068367216,-2.48842547695731,4.41414781905376,10.8090527622305,9.28865404751268,12.5026462186849,9.81504835429167,-0.130566088352832,-1.36528544784286,0.952450397353966,-1.14737386578547,5.47802124788419,14.7898553390862,11.3179271039564,7.77801482693653,8.96887647355727,0.921897259940479,-5.68832818259002,2.12612690400452,4.53299188894746,5.23119577363247,13.1734171984081,13.9340681549163,4.48520276092363,3.02592901147845,1.74244515554130,-4.55983504496260,1.18242928397727,7.58209255845094,8.39820597725250,9.16292721974752,11.9351166934218,5.72144382800123,-2.02940984861865,1.83425400304237,-0.219606836805673,-1.31428967001154,10.5357469169042,14.7320462648986,8.66317369550045,6.99384029602029,5.84922991457407,-2.96718817142569,-2.82611649629994,3.12341564852295,4.40990373719430,8.05571998003280,13.4975463658717,9.60551245970737,2.74037333746217,2.91702783872892,-0.903457793285593,-4.26564014936719,0.546261399528139,9.13005603813670,9.69742233680981,10.6947793850387,12.4986078242284,2.08873234403446,-1.66006330540453,1.19743970483576,-2.58120475631329,2.56510659687001,13.9042780158808,12.0384618042568,8.02561254888418,7.97668507210365,2.71689281106863,-4.39616389384125,0.151976379371711,3.85956239320529,4.1332279593848,011.5998449660372,16.4477574367340,4.69717667351133,3.91411426850493,3.05588658750614,-4.45480155876748,-2.66396087475018,7.54221554513682,12.8397269427868,11.8847204738406,11.7158486740892,11.1050940907217,-0.370616606586895,-0.425125141882483,1.28472176008446,-1.17493178524658,6.68758896750132,15.1444750129804,11.1942174708350,9.62076612992489,8.21367522899708,-2.38560854423819,-3.40033380456537,4.06418345935386,4.57521042477143,7.24675543353628,14.6653443318842,11.9632417636966,4.54394772421881,2.57652817164756,1.63366920086907,-5.58314744850048,0.431129541831943,8.43992076962173,5.62432228658675,12.2444644488559,12.9406112451567,2.98248926234964,-0.536167917624487,-0.916464496484099,-0.655715828124159,0.733796331922340,11.1370020372777,13.1918414775134,7.41322927340437,8.69061055706198,4.49069098890201,-3.37054383795810,-0.668215114984029,5.08767083112497,3.15529514821374,9.41231603863569,13.7708954190548,7.60654740648527,3.10086390808949,4.77557583807466,-2.70977994337034,-3.15613731770226,5.30620210004770,10.6657501919241,7.53944661141349,12.6030692363927,10.5627965733027,1.18765047967117,0.482034069012911,1.01533590610428,-2.69025453227190,3.90965662041271,12.2012969190328,13.2014698922737,7.37212628385832,9.09176290017356,0.546251486350722,-3.76995021360266,0.412055836305663,2.82366100046193,3.67364490644145,13.1463647727433,13.4952866742421,5.23063504407183,4.60757683492497,2.18008416385702,-3.83001261468943,1.08802477928820,7.65335594826139,9.57864544321221,10.7100199338476,12.8656138845006,6.12935343194416,-2.92118355016818,-0.843771290280274,0.134292621724418,0.472177775102770,11.5177808714005,12.8304764473064,9.08013117104257,8.41750557462911,4.36083481317021,-3.25021328963570,-4.89686359168650,4.22495482405339,3.07844974196104,7.76391860373974,14.2036963427076,10.8569941766881,2.88115286926895,3.91481071018109,0.156480836918994,-2.56622140774730,3.38131520517402,7.44871540956824,7.61538518308248,13.1160751120281,10.4927243731729,2.69936521241891,-1.50700774169263,2.45168416004871,-2.97704874152764,2.45194785071374,11.0924861800180,14.8481220603461,8.80945782962312,10.0898261627169,1.68952628309367,-5.09712648756634,-0.546880587287405,5.33079575281740,4.09181061035426,11.7637192846543,12.5620561222277,6.60217353674066,2.22835442297999,1.16006432484803,-2.63913861155627,-1.94838478877406,7.23307096084257,7.92765205963283,10.2427757222972,13.4159150248491,7.77110459405693,-1.07313103878133,-0.624065703658845,-1.18023351218842,-1.25561669854227,5.98036680414995,12.6755711000276,8.62878132537049,7.67001660717939,5.53954235950604,-0.213892198921448,-3.59751235443876,2.41392031854653,4.05154556843102,5.41389883905420,14.9571444806296,12.1334652089749,3.53554609333511,4.71519674383298,0.520502513058908,-5.02510637225213,1.20624640226455,8.40149322040858,7.44847814733797,13.3320838481592,14.2709182985879,4.04495274075767,-3.16358481707173,-0.0704161081852232,-0.730007496270193,1.76665943515817,9.48579087679681,10.5491157250709,6.82901189789013,9.05417268632413,5.04692361254395,-3.54657170655859,-1.89176543716917,4.16208662937246,3.54279495358351,10.1969785590622,13.6233179917995,9.17507770441653,2.25900385625912,2.90805859082582,-1.38733068367216,-2.48842547695731,4.41414781905376,10.8090527622305,9.28865404751268,12.5026462186849,9.81504835429167,-0.130566088352832,-1.36528544784286,0.952450397353966,-1.14737386578547,5.47802124788419,14.7898553390862,11.3179271039564,7.77801482693653,8.96887647355727,0.921897259940479,-5.68832818259002,2.12612690400452,4.53299188894746,5.23119577363247,13.1734171984081,13.9340681549163,4.48520276092363,3.02592901147845,1.74244515554130,-4.55983504496260,1.18242928397727,7.58209255845094,8.39820597725250,9.16292721974752,11.9351166934218,5.72144382800123,-2.02940984861865,1.83425400304237,-0.219606836805673,-1.31428967001154,10.5357469169042,14.7320462648986,8.66317369550045,6.99384029602029,5.84922991457407,-2.96718817142569,-2.82611649629994,3.12341564852295,4.40990373719430,8.05571998003280,13.4975463658717,9.60551245970737,2.74037333746217,2.91702783872892,-0.903457793285593,-4.26564014936719,0.546261399528139,9.13005603813670,9.69742233680981,10.6947793850387,12.4986078242284,2.08873234403446,-1.66006330540453,1.19743970483576,-2.58120475631329,2.56510659687001,13.9042780158808,12.0384618042568,8.02561254888418,7.97668507210365,2.71689281106863,-4.39616389384125,0.151976379371711,3.85956239320529,4.1332279593848,011.5998449660372,16.4477574367340,4.69717667351133,3.91411426850493,3.05588658750614,-4.45480155876748,-2.66396087475018,7.54221554513682,12.8397269427868,11.8847204738406,11.7158486740892,11.1050940907217,-0.370616606586895,-0.425125141882483,1.28472176008446,-1.17493178524658,6.68758896750132,15.1444750129804,11.1942174708350,9.62076612992489,8.21367522899708,-2.38560854423819,-3.40033380456537,4.06418345935386,4.57521042477143,7.24675543353628,14.6653443318842,11.9632417636966,4.54394772421881,2.57652817164756,1.63366920086907,-5.58314744850048,0.431129541831943,8.43992076962173,5.62432228658675,12.2444644488559,12.9406112451567,2.98248926234964,-0.536167917624487,-0.916464496484099,-0.655715828124159,0.733796331922340,11.1370020372777,13.1918414775134,7.41322927340437,8.69061055706198,4.49069098890201,-3.37054383795810,-0.668215114984029,5.08767083112497,3.15529514821374,9.41231603863569,13.7708954190548,7.60654740648527,3.10086390808949,4.77557583807466,-2.70977994337034,-3.15613731770226,5.30620210004770,10.6657501919241,7.53944661141349,12.6030692363927,10.5627965733027,1.18765047967117,0.482034069012911,1.01533590610428,-2.69025453227190,3.90965662041271,12.2012969190328,13.2014698922737,7.37212628385832,9.09176290017356,0.546251486350722,-3.76995021360266,0.412055836305663,2.82366100046193,3.67364490644145,13.1463647727433,13.4952866742421,5.23063504407183,4.60757683492497,2.18008416385702,-3.83001261468943,1.08802477928820,7.65335594826139,9.57864544321221,10.7100199338476,12.8656138845006,6.12935343194416,-2.92118355016818,-0.843771290280274,0.134292621724418,0.472177775102770,11.5177808714005,12.8304764473064,9.08013117104257,8.41750557462911,4.36083481317021,-3.25021328963570,-4.89686359168650,4.22495482405339,3.07844974196104,7.76391860373974,14.2036963427076,10.8569941766881,2.88115286926895,3.91481071018109,0.156480836918994,-2.56622140774730,3.38131520517402,7.44871540956824,7.61538518308248,13.1160751120281,10.4927243731729,2.69936521241891,-1.50700774169263,2.45168416004871,-2.97704874152764,2.45194785071374,11.0924861800180,14.8481220603461,8.80945782962312,10.0898261627169,1.68952628309367,-5.09712648756634,-0.546880587287405,5.33079575281740,4.09181061035426,11.7637192846543,12.5620561222277,6.60217353674066,2.22835442297999,1.16006432484803,-2.63913861155627,-1.94838478877406,7.23307096084257,7.92765205963283,10.2427757222972,13.4159150248491,7.77110459405693,-1.07313103878133,-0.624065703658845,-1.18023351218842,-1.25561669854227,5.98036680414995,12.6755711000276,8.62878132537049,7.67001660717939,5.53954235950604,-0.213892198921448,-3.59751235443876,2.41392031854653,4.05154556843102,5.41389883905420,14.9571444806296,12.1334652089749,3.53554609333511,4.71519674383298,0.520502513058908,-5.02510637225213,1.20624640226455,8.40149322040858,7.44847814733797,13.3320838481592,14.2709182985879,4.04495274075767,-3.16358481707173,-0.0704161081852232,-0.730007496270193,1.76665943515817,9.48579087679681,10.5491157250709,6.82901189789013,9.05417268632413,5.04692361254395,-3.54657170655859,-1.89176543716917,4.16208662937246,3.54279495358351,10.1969785590622,13.6233179917995,9.17507770441653,2.25900385625912,2.90805859082582,-1.38733068367216,-2.48842547695731,4.41414781905376,10.8090527622305,9.28865404751268,12.5026462186849,9.81504835429167,-0.130566088352832,-1.36528544784286,0.952450397353966,-1.14737386578547,5.47802124788419,14.7898553390862,11.3179271039564,7.77801482693653,8.96887647355727,0.921897259940479,-5.68832818259002,2.12612690400452,4.53299188894746,5.23119577363247,13.1734171984081,13.9340681549163,4.48520276092363,3.02592901147845,1.74244515554130,-4.55983504496260,1.18242928397727,7.58209255845094,8.39820597725250,9.16292721974752,11.9351166934218,5.72144382800123,-2.02940984861865,1.83425400304237,-0.219606836805673,-1.31428967001154,10.5357469169042,14.7320462648986,8.66317369550045,6.99384029602029,5.84922991457407,-2.96718817142569,-2.82611649629994,3.12341564852295,4.40990373719430,8.05571998003280,13.4975463658717,9.60551245970737,2.74037333746217,2.91702783872892,-0.903457793285593,-4.26564014936719,0.546261399528139,9.13005603813670,9.69742233680981,10.6947793850387,12.4986078242284,2.08873234403446,-1.66006330540453,1.19743970483576,-2.58120475631329,2.56510659687001,13.9042780158808,12.0384618042568,8.02561254888418,7.97668507210365,2.71689281106863,-4.39616389384125,0.151976379371711,3.85956239320529,4.1332279593848], dtype=np.complex64)

def pycuda_fft(data):
     # Make FFT plan
    plan = cf.cufftPlan1d(len(data), cf.CUFFT_C2C, BATCH)# calculate and time GPU FFT
    t1 = process_time()
    # transfer input data to Device
    data_t_gpu  = gpuarray.to_gpu(data)
    data_o_gpu  = gpuarray.empty_like(data_t_gpu)
    # Execute FFT plan
    cf.cufftExecC2C(plan, int(data_t_gpu.gpudata), int(data_o_gpu.gpudata), cf.CUFFT_FORWARD)

    dataFft_gpu = data_o_gpu.get()
    # print(dataFft_gpu/128)
    t2 = process_time()
    print('\nGPU time is: ',t2-t1)
    return dataFft_gpu

result = pycuda_fft(data)
print(result)